<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Wales Pleural Group ‚Äì Sign in</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-color: #020617;
      --card-bg: #020617;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.12);
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --danger: #f97373;
      --border-color: #1f2937;
      --shadow-soft: 0 24px 50px rgba(15, 23, 42, 0.85);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background:
        radial-gradient(circle at top, rgba(15, 23, 42, 0.9), transparent 55%),
        radial-gradient(circle at bottom, rgba(15, 23, 42, 0.9), #020617 60%);
      color: var(--text-main);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .shell {
      width: 100%;
      max-width: 720px;
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 0.99));
      border-radius: 26px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      padding: 18px 20px 24px;
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
    }

    @media (min-width: 768px) {
      .shell {
        padding: 22px 30px 26px;
      }
    }

    .shell::before {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        radial-gradient(circle at top left, rgba(56, 189, 248, 0.18), transparent 55%),
        radial-gradient(circle at bottom right, rgba(56, 189, 248, 0.06), transparent 55%);
      opacity: 0.5;
      pointer-events: none;
    }

    .content {
      position: relative;
      z-index: 1;
    }

    /* Top navigation */
    .nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 14px;
      margin-bottom: 18px;
      border-bottom: 1px solid rgba(31, 41, 55, 0.9);
      padding-bottom: 10px;
    }

    .nav-brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .nav-logo {
      width: 40px;
      height: auto;
      border-radius: 6px;
      display: block;
    }

    .nav-title {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .nav-title-main {
      font-size: 0.98rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .nav-title-sub {
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.86rem;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .nav-link {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid transparent;
      color: var(--text-muted);
      text-decoration: none;
      background: transparent;
      transition: all 0.16s ease-out;
    }

    .nav-link:hover {
      color: var(--text-main);
      border-color: rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.9);
    }

    .nav-link.active {
      color: #e0f2fe;
      border-color: rgba(56, 189, 248, 0.9);
      background: radial-gradient(circle at top, rgba(56, 189, 248, 0.18), rgba(15, 23, 42, 0.95));
      box-shadow: 0 12px 26px rgba(8, 47, 73, 0.8);
    }

    @media (max-width: 640px) {
      .nav {
        flex-direction: column;
        align-items: flex-start;
      }

      .nav-links {
        justify-content: flex-start;
      }
    }

    /* Page header */
    .page-header {
      margin-top: 6px;
      margin-bottom: 18px;
    }

    .page-kicker {
      font-size: 0.78rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.14em;
      margin-bottom: 4px;
    }

    .page-title-row {
      display: flex;
      flex-wrap: wrap;
      align-items: baseline;
      gap: 10px;
      justify-content: space-between;
    }

    .page-title-main {
      font-size: 1.45rem;
      letter-spacing: 0.03em;
    }

    .page-subtitle {
      font-size: 0.9rem;
      color: var(--text-muted);
      max-width: 620px;
      margin-top: 6px;
      margin-bottom: 0;
    }

    /* Card */
    .card {
      border-radius: 18px;
      border: 1px solid rgba(31, 41, 55, 0.95);
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.98), #020617);
      padding: 16px 18px 18px;
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.85);
    }

    .field-group {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-bottom: 10px;
    }

    label {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    input[type="email"],
    input[type="password"] {
      border-radius: 10px;
      border: 1px solid rgba(31, 41, 55, 0.95);
      background: rgba(15, 23, 42, 0.96);
      color: var(--text-main);
      font-size: 0.88rem;
      padding: 8px 10px;
      font-family: inherit;
    }

    input::placeholder {
      color: rgba(148, 163, 184, 0.9);
    }

    .helper-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.78rem;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .helper-row a {
      color: var(--accent);
      text-decoration: none;
    }

    .helper-row a:hover {
      text-decoration: underline;
    }

    .btn-primary {
      border-radius: 999px;
      border: none;
      background: radial-gradient(circle at top left, #38bdf8, #0ea5e9);
      color: #020617 !important;
      font-weight: 600;
      font-size: 0.9rem;
      padding: 9px 20px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 16px 32px rgba(8, 47, 73, 0.8);
      transition: all 0.16s ease-out;
      margin-top: 10px;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 20px 40px rgba(8, 47, 73, 0.95);
    }

    .small-text {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 10px;
    }

    .small-text a {
      color: var(--accent);
      text-decoration: none;
    }

    .small-text a:hover {
      text-decoration: underline;
    }
  
    .password-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .password-wrapper input[type="password"],
    .password-wrapper input[type="text"] {
      flex: 1;
      padding-right: 2.2rem;
    }

    .password-toggle {
      position: absolute;
      right: 0.55rem;
      background: transparent;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      font-size: 0.9rem;
      padding: 0;
    }

    .password-toggle:focus {
      outline: none;
      color: var(--accent);
    }

    .login-status {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .login-status.error {
      color: var(--danger);
    }

    .login-status.success {
      color: #4ade80;
    }

    .link-button {
      background: none;
      border: none;
      padding: 0;
      margin: 0;
      font: inherit;
      color: var(--accent);
      cursor: pointer;
      text-decoration: none;
    }

    .link-button:hover {
      text-decoration: underline;
    }

  </style>
</head>
<body>
  <main class="shell">
    <div class="content">
      <header class="nav">
        <div class="nav-brand">
          <img src="assets/branding/logo.png" class="nav-logo" alt="Wales Pleural Group logo" />
          <div class="nav-title">
            <div class="nav-title-main">Wales Pleural Group</div>
            <div class="nav-title-sub">Members login</div>
          </div>
        </div>
        <nav class="nav-links" aria-label="Primary">
          <a href="index.html" class="nav-link">Home</a>
          <a href="news.html" class="nav-link">News &amp; Events</a>
          <a href="about.html" class="nav-link">About</a>
          <a href="login.html" class="nav-link active">Members</a>
        </nav>
      </header>

      <header class="page-header">
        <div class="page-kicker">Members area</div>
        <div class="page-title-row">
          <div class="page-title-main">Sign in</div>
        </div>
        <p class="page-subtitle">
          Sign in to access protocols, forums, certificates and resources from previous Wales Pleural Group seminars.
        </p>
      </header>

      <section class="card" aria-label="Sign in form">
        <form>
          <div class="field-group">
            <label for="email">Email address</label>
            <input type="email" id="email" name="email" autocomplete="email"
              placeholder="name@wales.nhs.uk or NHS.net / work email" />
          </div>

          <div class="field-group">
            <label for="password">Password</label>
            <div class="password-wrapper">
              <input type="password" id="password" name="password" autocomplete="current-password"
                placeholder="Your password" />
              <button type="button" class="password-toggle" aria-label="Show password" id="password-toggle">üëÅ</button>
            </div>
            <div class="helper-row">
              <span id="login-status" class="login-status"></span>
              <button type="button" class="link-button" id="forgot-password-btn">Forgot password?</button>
            </div>
          </div>

          <button type="submit" class="btn-primary">
            <span>Log in</span>
            <span aria-hidden="true">‚Üí</span>
          </button>

          <p class="small-text">
            New to the members area?
            <a href="registration.html">Create an account</a>.
          </p>
          <p class="small-text">
            Problems signing in? Email
            <a href="mailto:admin@pleurawales.org.uk">admin@pleurawales.org.uk</a>.
          </p>
        </form>
      </section>
    </div>
  </main>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
    import {
      getAuth,
      signInWithEmailAndPassword,
      sendPasswordResetEmail
    } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAZq933hFxLT1K49auoZjBnYWEdi2mKUFI",
      authDomain: "pleural-seminar-2025.firebaseapp.com",
      projectId: "pleural-seminar-2025",
      storageBucket: "pleural-seminar-2025.appspot.com",
      messagingSenderId: "914784082205",
      appId: "1:914784082205:web:448e2d4fe8e9579075a9f4"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const form = document.querySelector("form");
    const emailInput = document.getElementById("email");
    const passwordInput = document.getElementById("password");
    const statusEl = document.getElementById("login-status");
    const forgotBtn = document.getElementById("forgot-password-btn");
    const toggleBtn = document.getElementById("password-toggle");

    function setStatus(message, type = "") {
      if (!statusEl) return;
      statusEl.textContent = message || "";
      statusEl.className = "login-status" + (type ? " " + type : "");
    }

    if (toggleBtn && passwordInput) {
      toggleBtn.addEventListener("click", () => {
        const isPassword = passwordInput.type === "password";
        passwordInput.type = isPassword ? "text" : "password";
        toggleBtn.textContent = isPassword ? "üôà" : "üëÅ";
        toggleBtn.setAttribute("aria-label", isPassword ? "Hide password" : "Show password");
      });
    }

    if (forgotBtn) {
      forgotBtn.addEventListener("click", async () => {
        setStatus("");
        const email = (emailInput.value || "").trim();
        if (!email) {
          setStatus("Please enter your email address first.", "error");
          return;
        }
        try {
          await sendPasswordResetEmail(auth, email);
          setStatus("If this email is registered, a password reset link has been sent.", "success");
        } catch (error) {
          console.error("sendPasswordResetEmail error:", error);
          let message = "There was a problem sending the reset email. Please try again.";
          if (error.code === "auth/user-not-found") {
            message = "No account found for that email address.";
          } else if (error.code === "auth/invalid-email") {
            message = "Please check the email address and try again.";
          }
          setStatus(message, "error");
        }
      });
    }

    if (form) {
      form.addEventListener("submit", async (event) => {
        event.preventDefault();
        setStatus("");

        const email = (emailInput.value || "").trim();
        const password = (passwordInput.value || "").trim();

        if (!email || !password) {
          setStatus("Please enter both email and password.", "error");
          return;
        }

        const button = form.querySelector("button[type='submit']");
        if (button) {
          button.disabled = true;
          button.innerHTML = "<span>Signing in‚Ä¶</span>";
        }

        try {
          await signInWithEmailAndPassword(auth, email, password);
          setStatus("Signed in successfully. Redirecting‚Ä¶", "success");
          window.location.href = "members.html";
        } catch (error) {
          console.error("signIn error:", error);
          let message = "Unable to sign in. Please check your details and try again.";
          if (error.code === "auth/wrong-password") {
            message = "Incorrect password. Please try again.";
          } else if (error.code === "auth/user-not-found") {
            message = "No account found for that email address.";
          } else if (error.code === "auth/invalid-email") {
            message = "Please check the email address and try again.";
          } else if (error.code === "auth/too-many-requests") {
            message = "Too many failed attempts. Please try again later or reset your password.";
          }
          setStatus(message, "error");
        } finally {
          const button2 = form.querySelector("button[type='submit']");
          if (button2) {
            button2.disabled = false;
            button2.innerHTML = "<span>Log in</span><span aria-hidden='true'>‚Üí</span>";
          }
        }
      });
    }
  </script>
</body>
</html>

