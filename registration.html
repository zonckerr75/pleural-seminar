<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>PleuraWales – Registration</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-color: #05060a;
      --card-bg: #111827;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.1);
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --danger: #f97373;
      --border-color: #1f2937;
      --radius-lg: 16px;
      --radius-sm: 8px;
      --shadow-soft: 0 22px 45px rgba(15, 23, 42, 0.7);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #0b1120 0, #020617 55%, #000 100%);
      color: var(--text-main);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .shell {
      width: 100%;
      max-width: 960px;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.96), rgba(2, 6, 23, 0.98));
      border-radius: 24px;
      border: 1px solid rgba(148, 163, 184, 0.3);
      box-shadow: var(--shadow-soft);
      padding: 24px;
    }

    @media (min-width: 768px) {
      .shell {
        padding: 32px 40px;
      }
    }

    .header {
      display: flex;
      justify-content: space-between;
      gap: 16px;
      align-items: flex-start;
      margin-bottom: 24px;
      border-bottom: 1px solid rgba(31, 41, 55, 0.9);
      padding-bottom: 16px;
    }

    .title-block h1 {
      margin: 0;
      font-size: 1.5rem;
      letter-spacing: 0.02em;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .badge {
      font-size: 0.75rem;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(56, 189, 248, 0.12);
      border: 1px solid rgba(56, 189, 248, 0.4);
      color: var(--accent);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .subtitle {
      margin: 6px 0 0;
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .info-note {
      font-size: 0.78rem;
      color: var(--text-muted);
      max-width: 360px;
      text-align: right;
      line-height: 1.5;
    }

    .info-note strong {
      color: var(--accent);
      font-weight: 500;
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(0, 2.3fr);
      gap: 24px;
    }

    @media (max-width: 900px) {
      .layout {
        grid-template-columns: minmax(0, 1fr);
      }
      .info-note {
        max-width: 100%;
        text-align: left;
      }
    }

    .pane {
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.98));
      border-radius: var(--radius-lg);
      border: 1px solid rgba(31, 41, 55, 0.95);
      padding: 18px 18px 20px;
      position: relative;
      overflow: hidden;
    }

    .pane::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.12), transparent 55%);
      opacity: 0.4;
      pointer-events: none;
    }

    .pane-header {
      position: relative;
      z-index: 1;
      margin-bottom: 12px;
    }

    .pane-title {
      font-size: 0.95rem;
      font-weight: 600;
      margin: 0 0 4px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .pane-title span.dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 6px rgba(34, 197, 94, 0.15);
    }

    .pane-title span.dot.pending {
      background: #f97316;
      box-shadow: 0 0 0 6px rgba(249, 115, 22, 0.15);
    }

    .pane-subtitle {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .toggle-row {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
      position: relative;
      z-index: 1;
    }

    .toggle-btn {
      flex: 1;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(31, 41, 55, 0.9);
      background: rgba(15, 23, 42, 0.85);
      color: var(--text-muted);
      font-size: 0.8rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      cursor: pointer;
      transition: all 0.18s ease-out;
      white-space: nowrap;
    }

    .toggle-btn span.label {
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .toggle-btn.active {
      background: radial-gradient(circle at top, rgba(56, 189, 248, 0.2), rgba(15, 23, 42, 0.95));
      border-color: rgba(56, 189, 248, 0.9);
      color: var(--text-main);
      box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.8);
    }

    .toggle-btn small {
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .form {
      position: relative;
      z-index: 1;
    }

    .field-row {
      display: flex;
      gap: 10px;
    }

    @media (max-width: 600px) {
      .field-row {
        flex-direction: column;
      }
    }

    .field {
      margin-bottom: 10px;
      flex: 1;
    }

    .field label {
      display: block;
      font-size: 0.78rem;
      color: var(--text-muted);
      margin-bottom: 4px;
    }

    .input,
    .textarea {
      width: 100%;
      padding: 8px 10px;
      border-radius: var(--radius-sm);
      border: 1px solid rgba(31, 41, 55, 0.95);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-main);
      font-size: 0.85rem;
      outline: none;
      transition: all 0.16s ease-out;
    }

    .input:focus,
    .textarea:focus {
      border-color: rgba(56, 189, 248, 0.8);
      box-shadow: 0 0 0 1px rgba(8, 47, 73, 0.7);
      background: rgba(15, 23, 42, 0.98);
    }

    .input::placeholder,
    .textarea::placeholder {
      color: rgba(148, 163, 184, 0.7);
    }

    .textarea {
      min-height: 60px;
      resize: vertical;
    }

    .hint {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 2px;
    }

    .hint strong {
      color: var(--accent);
      font-weight: 500;
    }

    .error {
      margin-top: 4px;
      font-size: 0.75rem;
      color: var(--danger);
    }

    .success {
      margin-top: 6px;
      font-size: 0.8rem;
      color: #4ade80;
    }

    .btn-row {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 8px;
    }

    .btn-primary {
      border: none;
      border-radius: 999px;
      background: radial-gradient(circle at top left, #38bdf8, #0ea5e9);
      color: #0b1120;
      font-weight: 600;
      font-size: 0.83rem;
      padding: 8px 18px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 14px 30px rgba(8, 47, 73, 0.65);
      transition: all 0.16s ease-out;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 18px 40px rgba(8, 47, 73, 0.9);
    }

    .btn-primary:active {
      transform: translateY(0);
      box-shadow: 0 10px 24px rgba(8, 47, 73, 0.7);
    }

    .btn-primary[disabled] {
      opacity: 0.6;
      cursor: default;
      box-shadow: none;
    }

    .btn-ghost {
      border-radius: 999px;
      border: 1px solid rgba(31, 41, 55, 0.95);
      background: rgba(15, 23, 42, 0.7);
      color: var(--text-muted);
      font-size: 0.78rem;
      padding: 6px 12px;
      cursor: pointer;
    }

    .list {
      list-style: none;
      padding: 0;
      margin: 8px 0 0;
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .list li {
      display: flex;
      align-items: flex-start;
      gap: 6px;
      margin-bottom: 4px;
    }

    .list li span.bullet {
      display: inline-block;
      width: 4px;
      height: 4px;
      border-radius: 999px;
      margin-top: 6px;
      background: rgba(148, 163, 184, 0.8);
    }

    .list li strong {
      color: var(--accent);
      font-weight: 500;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 0.7rem;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: rgba(15, 23, 42, 0.8);
      color: var(--text-muted);
      margin-right: 5px;
      margin-top: 4px;
    }

    .pill span.dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.7);
    }
  </style>
</head>
<body>
  <main class="shell">
    <header class="header">
      <div class="title-block">
        <h1>
          PleuraWales Portal
          <span class="badge">Members area</span>
        </h1>
        <p class="subtitle">
          Create an account to access members-only resources, videos and downloads.
        </p>
      </div>
      <p class="info-note">
        This registration system is intended for healthcare professionals involved in pleural disease, thoracic oncology and related specialties.
        <br /><br />
        <strong>NHS email users</strong> can self-register. Other professional email addresses will be reviewed before access is granted.
      </p>
    </header>

    <section class="layout">
      <!-- Left: NHS email self-registration -->
      <section class="pane" aria-labelledby="nhs-title">
        <div class="pane-header">
          <h2 class="pane-title" id="nhs-title">
            <span class="dot"></span>
            Register with NHS email
          </h2>
          <p class="pane-subtitle">
            For standard NHS domains such as <strong>@wales.nhs.uk</strong> and <strong>@nhs.net</strong>.
            You will receive an email to verify your address and set a password.
          </p>
        </div>

        <div class="toggle-row" aria-hidden="true">
          <button class="toggle-btn active" type="button">
            <span class="label">NHS email</span>
            <small>@wales.nhs.uk · @nhs.net</small>
          </button>
          <button class="toggle-btn" type="button" disabled>
            <span class="label">Other work email</span>
            <small>See panel on the right</small>
          </button>
        </div>

        <form class="form" id="nhs-form" novalidate>
          <div class="field-row">
            <div class="field">
              <label for="nhs-name">Full name</label>
              <input class="input" id="nhs-name" name="name" autocomplete="name" required />
            </div>
            <div class="field">
              <label for="nhs-organisation">Organisation</label>
              <input class="input" id="nhs-organisation" name="organisation" autocomplete="organization" required />
            </div>
          </div>

          <div class="field">
            <label for="nhs-email">NHS email address</label>
            <input
              class="input"
              id="nhs-email"
              name="email"
              type="email"
              autocomplete="email"
              placeholder="name@wales.nhs.uk or name@nhs.net"
              required
            />
            <p class="hint">
              We currently support <strong>@wales.nhs.uk</strong> and <strong>@nhs.net</strong> for
              automatic registration. Other NHS / trust domains should use the form on the right.
            </p>
            <p class="error" id="nhs-error" hidden></p>
            <p class="success" id="nhs-success" hidden></p>
          </div>

          <div class="btn-row">
            <button class="btn-primary" type="submit" id="nhs-submit">
              <span>Register with NHS email</span>
              <span aria-hidden="true">→</span>
            </button>
          </div>

          <p class="hint">
            After submitting, you will receive an email with a link to verify your address and set a password.
          </p>
        </form>
      </section>

      <!-- Right: Other professional email (manual approval) -->
      <aside class="pane" aria-labelledby="other-title">
        <div class="pane-header">
          <h2 class="pane-title" id="other-title">
            <span class="dot pending"></span>
            Register with other work email
          </h2>
          <p class="pane-subtitle">
            For hospital trust domains, university addresses and other professional emails. Your request will be
            reviewed before an account is created.
          </p>
        </div>

        <div class="form" id="other-form-wrapper">
          <div class="field">
            <label for="other-name">Full name</label>
            <input class="input" id="other-name" autocomplete="name" />
          </div>

          <div class="field">
            <label for="other-organisation">Organisation / role</label>
            <input class="input" id="other-organisation" autocomplete="organization" />
          </div>

          <div class="field">
            <label for="other-email">Work email address</label>
            <input
              class="input"
              id="other-email"
              type="email"
              autocomplete="email"
              placeholder="trust, health board or university email"
            />
          </div>

          <div class="field">
            <label for="other-reason">Optional note</label>
            <textarea
              class="textarea"
              id="other-reason"
              placeholder="Briefly describe your role and why you would like access (optional)."
            ></textarea>
            <p class="hint">
              Your request will be sent to the PleuraWales team for manual approval. You will receive an email if your
              account is approved.
            </p>
            <p class="error" id="other-error" hidden></p>
            <p class="success" id="other-success" hidden></p>
          </div>

          <div class="btn-row">
            <button class="btn-primary" type="button" id="other-submit">
              <span>Request registration</span>
              <span aria-hidden="true">→</span>
            </button>
          </div>
        </div>

        <ul class="list">
          <li>
            <span class="bullet"></span>
            <span>
              Typical examples include <strong>trust-specific NHS domains</strong>, health boards and
              <strong>university addresses</strong>.
            </span>
          </li>
          <li>
            <span class="bullet"></span>
            <span>
              Industry colleagues and invited external speakers can also use this route; please include enough
              information for us to recognise your request.
            </span>
          </li>
        </ul>

        <div>
          <span class="pill">
            <span class="dot"></span>
            <span>Manual approval required</span>
          </span>
          <span class="pill">
            <span class="dot"></span>
            <span>Reviewed by admin@pleurawales.org.uk</span>
          </span>
        </div>
      </aside>
    </section>
  </main>

  <script>
    // Basic client-side behaviour only.
    // Firebase calls will be wired in later.

    (function () {
      const nhsForm = document.getElementById("nhs-form");
      const nhsError = document.getElementById("nhs-error");
      const nhsSuccess = document.getElementById("nhs-success");
      const nhsSubmit = document.getElementById("nhs-submit");

      const otherName = document.getElementById("other-name");
      const otherOrg = document.getElementById("other-organisation");
      const otherEmail = document.getElementById("other-email");
      const otherReason = document.getElementById("other-reason");
      const otherError = document.getElementById("other-error");
      const otherSuccess = document.getElementById("other-success");
      const otherSubmit = document.getElementById("other-submit");

      function isNhsEmail(email) {
        if (!email) return false;
        const e = email.trim().toLowerCase();
        return e.endsWith("@wales.nhs.uk") || e.endsWith("@nhs.net");
      }

      nhsForm.addEventListener("submit", function (e) {
        e.preventDefault();
        nhsError.hidden = true;
        nhsSuccess.hidden = true;

        const name = document.getElementById("nhs-name").value.trim();
        const org = document.getElementById("nhs-organisation").value.trim();
        const email = document.getElementById("nhs-email").value.trim();

        if (!name || !org || !email) {
          nhsError.textContent = "Please complete all fields.";
          nhsError.hidden = false;
          return;
        }

        if (!isNhsEmail(email)) {
          nhsError.textContent =
            "Please use a standard NHS email address ending in @wales.nhs.uk or @nhs.net for automatic registration.";
          nhsError.hidden = false;
          return;
        }

        // Placeholder: this is where we will call a Firebase Function (registerNhsUser)
        nhsSubmit.disabled = true;
        nhsSubmit.textContent = "Submitting...";

        setTimeout(function () {
          nhsSuccess.textContent =
            "If this email is eligible, you will shortly receive a message with a link to verify your address and set your password.";
          nhsSuccess.hidden = false;
          nhsSubmit.disabled = false;
          nhsSubmit.textContent = "Register with NHS email";
        }, 600);
      });

      otherSubmit.addEventListener("click", function () {
        otherError.hidden = true;
        otherSuccess.hidden = true;

        const name = otherName.value.trim();
        const org = otherOrg.value.trim();
        const email = otherEmail.value.trim();
        const reason = otherReason.value.trim();

        if (!name || !org || !email) {
          otherError.textContent = "Please complete your name, organisation and email.";
          otherError.hidden = false;
          return;
        }

        // Basic email format check
        if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
          otherError.textContent = "Please enter a valid work email address.";
          otherError.hidden = false;
          return;
        }

        // Placeholder: this is where we will write to Firestore (registrationRequests)
        otherSubmit.disabled = true;
        otherSubmit.textContent = "Sending...";

        setTimeout(function () {
          otherSuccess.textContent =
            "Your registration request has been recorded. You will receive an email once it has been reviewed.";
          otherSuccess.hidden = false;
          otherSubmit.disabled = false;
          otherSubmit.textContent = "Request registration";
          // We don't clear fields yet, in case they want to edit.
        }, 600);
      });
    })();
  </script>
</body>
</html>
